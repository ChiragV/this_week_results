<html>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" > </script>
<script type="text/javascript" src="http://html2canvas.hertzen.com/dist/html2canvas.min.js" /> </script>


<script>
var  URL="https://www.moneycontrol.com/india/stockpricequote/";
var j=0;
const data = [{
    name: 'infosys',
    url: URL+"computers-software/infosys/IT",
	date1 :Date.now(),
	logo:"https://toppng.com/uploads/preview/infosys-vector-logo-free-download-11574200524wvzgyrao38.png"
  },
  {
    name: 'Titan',
    url: URL+"miscellaneous/titancompany/TI01",
	date1 :Date.now(),
	logo:"https://s3.ap-southeast-1.amazonaws.com/images.asianage.com/images/aa-Cover-ajdtihb7lo9cannqf6ugbmebm0-20161222011156.Medi.jpeg"
  }, {
   name: 'HDFC Bank',
    url: URL+"banks-private-sector/hdfcbank/HDF01",
	date1 :Date.now(),
	logo :"https://static.india.com/wp-content/uploads/2015/11/hdfc-bank-logo_regular-2.jpg"
  },
  {
    name: 'ICICI',
    url: URL+"banks-private-sector/icicibank/ICI02",
	date1 :Date.now(),
	logo :"https://img.etimg.com/thumb/width-640,height-480,imgsize-180986,resizemode-1,msid-71765131/industry/banking/finance/banking/icici-bank-sells-entire-stake-in-gst-network-to-13-state-governments/icici-bank-others.jpg"
	
  },
  {
    name: 'Kotak',
    url: URL+"banks-private-sector/kotakmahindrabank/KMB",
	date1 :Date.now(),
	logo :"http://persona-stars.com/files/2017/11/kotak-mahindra-bank-logo-1-300x180.jpg"
	
  },
  {
    name: 'Bajaj Finance Ltd',
    url: URL+"finance-leasinghire-purchase/bajajfinance/BAF",
	date1 :Date.now(),
	logo :"https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Bajaj_Finserv_Logo.svg/1280px-Bajaj_Finserv_Logo.svg.png"
	
  },
  {
    name: 'SBI',
    url: URL+"banks-public-sector/statebankindia/SBI",
	date1 :Date.now(),
	logo :"http://www.logo-designer.co/wp-content/uploads/2017/04/2017-Design-Stack-new-logo-design-State-Bank-of-India.png"
	
  },
  {
    name: 'HDFC',
    url: URL+"finance-housing/housingdevelopmentfinancecorporation/HDF",
	date1 :Date.now(),
	logo :"https://investeek.com/wp-content/uploads/2019/10/HDFC.png"
	
  },
  {
    name: 'ONGC',
    url: URL+"oil-drillingexploration/oilnaturalgascorporation/ONG",
	date1 :Date.now(),
	logo :"https://upload.wikimedia.org/wikipedia/en/thumb/9/9a/ONGC_Logo.svg/250px-ONGC_Logo.svg.png"
	
  }
]

var weekday = new Array(7);
  weekday[0] = "Sunday";
  weekday[1] = "Monday";
  weekday[2] = "Tuesday";
  weekday[3] = "Wednesday";
  weekday[4] = "Thursday";
  weekday[5] = "Friday";
  weekday[6] = "Saturday";

for (i = 0; i < data.length; i++) 
{



var date2;
var proxyUrl = 'https://cors-anywhere.herokuapp.com/',
    targetUrl = 'https://www.bseindia.com/corporates/Forth_Results.aspx'
  fetch(data[i].url, {


  method: "GET", 
  //body: JSON.stringify(data)
}).then((response) => response.text()).
then((text) => {

text=text.trim();
var start=text.indexOf('table class="mctable1 thborder frtab" width="100%" cellspacing="0" cellpadding="0"');
var tableText=text.substring(start,start+2000).replace(/\s/g, '');
var dateStart=tableText.indexOf('</th><th>Agenda</th></tr></thead><tbody><tr><td>');
tableText=tableText.substring(dateStart,dateStart+100).replace('</th><th>Agenda</th></tr></thead><tbody><tr><td>','');
dateStart=tableText.indexOf('</td>');
date2=new Date(tableText.substring(0,dateStart));
if (date2 instanceof Date) console.log(data[j].name+date2);
console.log(tableText.substring(0,dateStart));
console.log(j);
data[j].date1=date2;


//document.write(data[j].name+":"+data[j].date1+":"+weekday[data[j].date1.getDay()]+"<br>");
//document.getElementById(weekday[data[j].date1.getDay()]).innerHTML=data[j].name+":"+data[j].date1+":"+weekday[data[j].date1.getDay()];
console.log(document.getElementById(weekday[data[j].date1.getDay()]));
document.getElementById(weekday[data[j].date1.getDay()]).innerHTML=document.getElementById(weekday[data[j].date1.getDay()]).innerHTML+"&nbsp;<img src="+ data[j].logo+" width='50' height='50'/>";
console.log('------------------------------------------------');
j=j+1;
}
).catch(e => {
    console.log(e);
    return e;
  });
 
 
}

function callme() {


/*
html2canvas(document.body,{useCORS: true,
	allowTaint: true,} ).then(function(canvas) 
{
	
    document.body.appendChild(canvas);
}

);*/
}



function onCurrentWeek(date) {

    var lastMonday = new Date(); // Creating new date object for today
    lastMonday.setDate(lastMonday.getDate() - (lastMonday.getDay()-1)); // Setting date to last monday
    lastMonday.setHours(0,0,0,0); // Setting Hour to 00:00:00:00
    


    const res = lastMonday.getTime() < date.getTime() &&
                date.getTime() < ( lastMonday.getTime() + WEEK_LENGTH);
    return res; // Boolean
}
</script>
<body>
 <div id="boundary">
<table border="1" id="mycanvas">
<tr>
<td>Sunday</td>
<td>Monday</td>
<td>Tuesday</td>
<td>Wednesday</td>
<td>Thrusday</td>
<td>Friday</td>
<td>Saturday</td>

</tr>
<tr>
<td id="Monday"></td>
<td id="Tuesday"></td>
<td id="Wednesday"></td>
<td id="Thursday"></td>
<td id="Friday"></td>
<td id="Saturday"></td>
<td id="Sunday"></td>
</tr>
</table>
 </div>
<button id="download">Download</button>
</body>
	<script>
document.getElementById("download").addEventListener("click", function() {

    html2canvas(document.querySelector('#boundary'),{useCORS: true,
	allowTaint: true,}).then(function(canvas) {

        console.log(canvas);
        saveAs(canvas.toDataURL(), 'file-name.png');
    });
});


function saveAs(uri, filename) {

    var link = document.createElement('a');

    if (typeof link.download === 'string') {

        link.href = uri;
        link.download = filename;

        //Firefox requires the link to be in the body
        document.body.appendChild(link);

        //simulate click
        link.click();

        //remove the link when done
        document.body.removeChild(link);

    } else {

        window.open(uri);

    }
}
</script>
</html>