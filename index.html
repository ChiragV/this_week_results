<!DOCTYPE html prefix="og: http://ogp.me/ns#">
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-173939724-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173939724-1');
</script>

  <title>Indian stock market most awaited earnings this week</title>
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://chirag-vithlani.github.io/this_week_results/"/>
  <meta name="twitter:site" content="https://chirag-vithlani.github.io/this_week_results/">
  <meta name="twitter:image" content="https://raw.githubusercontent.com/chirag-vithlani/this_week_results/master/this_week2.png">
  <meta name="twitter:title" content="BSE/Nifty/Large cap earning this week">
  <meta name="twitter:description" content="If you invest in Indian stock market, then you should keep track of earnings to avoid any surprises. This site will display most awaited earnings this week.">
  <meta name="twitter:creator" content="@ChiragVithlani">
  
  <meta  prefix="og: http://ogp.me/ns#" property="og:description" content="If you invest in Indian stock market, then you should keep track of earnings to avoid any surprises. This site will display most awaited earnings this week." />
  <meta  prefix="og: http://ogp.me/ns#" property="og:type" content="website" />
  <meta  prefix="og: http://ogp.me/ns#" property="og:title" content="India stock market earnings calendar" />
  <meta  prefix="og: http://ogp.me/ns#" property="og:url" content="https://chirag-vithlani.github.io/this_week_results/" />
  <meta  prefix="og: http://ogp.me/ns#" property="og:image" content="./this_week2.png">
  
  <link rel="icon" href="./images/twr.ico" type="image/ico" defer>
  <link rel="stylesheet" type="text/css" href="./mycss.css" async>
  
<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" > </script>
<script type="text/javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.min.js" defer> </script>
<script>
function MyData(ID, name, date,FullName){
  this.ID = ID;
  this.name = name;
  this.date = new Date(date);
  this.FullName=FullName;
}
var weekday = new Array(7);
  weekday[0] = "Sunday";
  weekday[1] = "Monday";
  weekday[2] = "Tuesday";
  weekday[3] = "Wednesday";
  weekday[4] = "Thursday";
  weekday[5] = "Friday";
  weekday[6] = "Saturday";
function callme(day,logo,FullName){
//console.log(day+":"+weekday[day]+":"+logo);
var myDay=weekday[day];  
if(myDay=='Sunday' || myDay=='Saturday') myDay="Weekend";
document.getElementById(myDay).innerHTML=document.getElementById(myDay).innerHTML+"<img title='"+FullName+"'src='https://raw.githubusercontent.com/chirag-vithlani/this_week_results/master/images/"+logo.trim()+".jpg'  height='50'/>&nbsp;&nbsp";
}
function onCurrentWeek(date) {
	const WEEK_LENGTH = 604800000; var lastMonday = new Date();lastMonday.setDate(lastMonday.getDate() - (lastMonday.getDay()-1));
    lastMonday.setHours(0,0,0,0); date.setHours(0,0,0,0);
    const res = lastMonday.getTime() <= date.getTime() &&
    date.getTime() < ( lastMonday.getTime() + WEEK_LENGTH);
    return res; 
}
let apiRequestLoop = function() {
  let promiseArray = [];
   $.ajax({url: "https://spreadsheets.google.com/feeds/cells/15CoBpWSHfWPttaNPtJEbYZqGKApG7tMdgg2GQbuWwdU/1/public/full?alt=json", success: function(result){
    var res=result.feed;
	for (let i = 0; i < res.entry.length; i=i+4){
	//console.log(res.entry[i].gs$cell.inputValue+":"+res.entry[i+1].gs$cell.inputValue+":"+res.entry[i+2].gs$cell.inputValue);
	var myDataObj = new MyData(res.entry[i].gs$cell.inputValue, res.entry[i+1].gs$cell.inputValue, res.entry[i+2].gs$cell.inputValue,res.entry[i+3].gs$cell.inputValue);
	promiseArray.push(myDataObj);
	if(onCurrentWeek(myDataObj.date))
	{
	callme(myDataObj.date.getDay(),myDataObj.name,myDataObj.FullName);
	}}
	//console.log(promiseArray.length);
  }});
}
$(document).ready(function() {
    my_data=apiRequestLoop();
});
</script></head>
<body><div id="boundary">
<table  id="mycanvas"  ><thead ><tr><td colspan="7" style="background-color:lightblue;">Indian stock market most awaited earnings this week</td></tr>
</thead ><thead >
<tr>
<td >Monday</td>
<td>Tuesday</td>
<td>Wednesday</td>
<td>Thrusday</td>
<td>Friday</td>
<td>Weekend</td>
</tr>
</thead>
<tr>
<td id="Monday" ><br/></td><td id="Tuesday"><br/></td><td id="Wednesday"><br/>
</td>
<td id="Thursday"><br/></td>
<td id="Friday"><br/></td>
<td id="Weekend" style="width:5%"><br/></td>
</tr>
</table><div >https://chirag-vithlani.github.io/this_week_results/</div><br/>
 </div>
<button id="download" style="background-color:lightgreen">Download | Share</button>&nbsp;
<button class="button" onClick="window.open('https://forms.gle/vNMUxpZwNkHipCKw6');" style="background-color:lightblue">
     <span >Feedback  | Comments | Questions</span>
</button>&nbsp;

<button onclick="myFunction()">Tweet</button>


</body>
	<script>
function myFunction() {
  window.open("https://twitter.com/intent/tweet?url=https://chirag-vithlani.github.io/this_week_results&text=India+stock+market+most+awaited+earning+this week&via=ChiragVithlani","", toolbar=0, status=0, width=650, height=420);
}
document.getElementById("download").addEventListener("click", function() {
    html2canvas(document.querySelector('#boundary'),{useCORS: true,
	allowTaint: true,}).then(function(canvas) {
        console.log(canvas);
        saveAs(canvas.toDataURL(), 'Market_Earning_Cal.png');
    });
});
function saveAs(uri, filename) {
    var link = document.createElement('a');
    if (typeof link.download === 'string') {
        link.href = uri;
        link.download = filename;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    } else {
        window.open(uri);
    }
}
</script>
<br />
</html>